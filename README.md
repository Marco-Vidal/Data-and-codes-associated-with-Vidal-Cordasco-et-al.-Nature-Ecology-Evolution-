# Data-and-codes-associated-with-Vidal-Cordasco-et-al.-Nature-Ecology-Evolution-
This repository contains the directories "code" and "data" to reproduce the models, calculations and figure rendering of the paper: Vidal-Cordasco, M; Ocio, D.; Hickler, T., Marín-Arroyo, A.B. (under review) "Spatiotemporal replacement patterns of Neanderthals in Iberia affected by the ecosystems’ productivity". The file 1_Main_Script.R includes the functions to estimate the herbivore biomass of each herbivore species according to the bottom-up processes of the food chain regulation driven by the Net Primary Productivity (NPP), the specific herbivore guild composition in each ecosystem, and the allometric relationships between body mass and population density. This script was also used to analyse and compare the estimated NPP between the four biogeographic regions of Iberia during the MIS 3. Therefore, this code generates the main results and figures as found in the paper. The file 2_HB_Validation.R reproduces the validation process of the macroecological model to estimate herbivore abundances (used in the 1_Main_Script.R) against empirical present-day herbivore densities from a broad range of terrestrial ecosystems. The file 3_NB_NPP.R includes the analyses of the association between NPP and herbivore biomass in different ecosystems and computes a predictive model. The file 4_Pollen.R was used to perform pollen-based paleoclimate reconstructions with weighted averaging (WA) regressions. These predictive functions are used to estimate temperature and precipitation from the palynological fossil record. Finally, these estimations are used to assess the accuracy of a general paleoclimatic circulation model. The file 5_Rarefaction.R performs a rarefaction analysis with the local faunal assemblages in each biogeographic region of Iberia during the MIS 3. As the data and code in this repository are complete, it can be reproduced with only an R environment (tested for R v4.1.0) in RStudio. The necessary package dependencies are documented in each .R file.
